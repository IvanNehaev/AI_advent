# AI_advent

## Day 8. Работа с токенами

Локальный подсчет возможен, но всегда будет расхождение с фактическим.
Точный подсчёт возможен только по usage, который вернул API.

| Usage  | Local  | Diff  |
| ------ | ------ | ----- |
| 33172  | 39100  | 5928  |
| 94940  | 11859  | 23650 |
| 187262 | 220707 | 33445 |
| 311335 | 366997 | 55662 |

1. Почему локальный подсчёт — проблема
1.1 Tokenizer жёстко привязан к модели

у каждой модели свой словарь и правила

смена модели = смена tokenizer

minor-версия модели → могут измениться токены

1.2 Есть «скрытые» токены

API может добавлять:

system tokens

role separators

function / tool-call маркеры

JSON framing

